# Short description and score
Ticket cart and price determination are done client-side. Tickets can be bought for free. There is no limit to the amount of tickets one can buy, causing the unavailability of tickets. 

## CVSS:
- Score: **9.8** (CRITICAL)
- Vector: `CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H/E:H/IR:M/AR:H/MAV:N`

# Description
Due to the fact the ticket system running lots of tasks client side, the system is vulnerable to attackers that make use of debugging tools shipped with common browsers.

These browsers allow debugging scripts. One really neat feature is setting breakpoints. Breakpoints allow the browser to pause the execution of scripts at specific points.

For this exploit, we set a breakpoint at line 1198:
```js
form.addEventListener('submit', function (event) {
            event.preventDefault();

            var sourceData = {
                type: 'ideal',
                amount: parseInt(price * 100), // Set a breakpoint here
                currency: 'eur',
                owner: {
//                    email: hidden_email,
                },
                redirect: {
                    return_url: redirect_url
                },
            };
```

Next, we buy some tickets. The script will pause just before we go to iDeal to pay for our tickets.

Now because the browser stopped further execution of the scripts, we can edit it's variable. This includes the `price` variable. We can set this variable to any price we want, as long this value is > 0. 

In our example, we set `price` to `0.01` (via the browser's console). We now resume code execution.

In a few moments we get redirected to iDeal prompting us to pay â‚¬0.01. If we were to pay, this would result in a good payment and us getting our tickets.

# Demo
https://youtu.be/DAybXOmv08g

# Note
This exploit has been confirmed fixed since 2021-04-04